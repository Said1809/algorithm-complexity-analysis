# hash_functions.py
# Модуль хеш-функций для строковых ключей
"""
Три хеш-функции для строк:
- simple_hash: сумма кодов символов
- poly_hash: полиномиальная (rolling) хеш-функция
- djb2_hash: DJB2
Каждая функция принимает строку и возвращает целое (неотрицательное).
"""

def simple_hash(s: str) -> int:  # O(n) где n — длина строки s
    """Простая: сумма кодов символов.
    Особенности: простая, много коллизий при похожих словах.
    Сложность: O(n) где n — длина строки
    """
    return sum(ord(c) for c in s) & 0x7fffffff  # O(n)

def poly_hash(s: str, base: int = 257, mod: int = 2**61 - 1) -> int:  # O(n)
    """Полиномиальная (rolling) hash: sum(s[i]*base^i) mod mod.
    Хорошее распределение при выбранном base. Быстрая на строках.
    Сложность: O(n) где n — длина строки
    """
    h = 0  # O(1)
    for ch in s:  # O(n) цикл по каждому символу
        h = (h * base + ord(ch)) % mod  # O(1) операция на каждой итерации
    return int(h & 0x7fffffff)  # O(1)

def djb2_hash(s: str) -> int:  # O(n)
    """DJB2 — простая и часто используемая хеш-функция.
    Начинается с 5381, h = h*33 + c.
    Сложность: O(n) где n — длина строки
    """
    h = 5381  # O(1)
    for ch in s:  # O(n) цикл по каждому символу
        h = ((h << 5) + h) + ord(ch)  # O(1) побитовые операции и сложение
    return h & 0x7fffffff  # O(1)
